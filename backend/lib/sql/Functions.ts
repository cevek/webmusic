import {Expression} from "./Expression";
import {toSql} from "./common";
import {RawSQL} from "./DataSource";
import {QueryValues} from "./Base";
export class Fun extends Expression {
    constructor(private name: string, private args: Expression[]) {
        super();
    }

    toSQL(values: QueryValues) {
        return `${toSql(new RawSQL(this.name), values)}(${this.args.map(arg => toSql(arg, values)).join(', ')})`;
    }
}

function funBuilder(name: string) {
    return (...args: Expression[]): Fun => {
        return new Fun(name, args);
    }
}

export const Functions = {
    ABS: funBuilder("ABS"),
    ACOS: funBuilder("ACOS"),
    ADDDATE: funBuilder("ADDDATE"),
    ADDTIME: funBuilder("ADDTIME"),
    AES_DECRYPT: funBuilder("AES_DECRYPT"),
    AES_ENCRYPT: funBuilder("AES_ENCRYPT"),
    ANY_VALUE: funBuilder("ANY_VALUE"),
    ASCII: funBuilder("ASCII"),
    ASIN: funBuilder("ASIN"),
    ASYMMETRIC_DECRYPT: funBuilder("ASYMMETRIC_DECRYPT"),
    ASYMMETRIC_DERIVE: funBuilder("ASYMMETRIC_DERIVE"),
    ASYMMETRIC_ENCRYPT: funBuilder("ASYMMETRIC_ENCRYPT"),
    ASYMMETRIC_SIGN: funBuilder("ASYMMETRIC_SIGN"),
    ASYMMETRIC_VERIFY: funBuilder("ASYMMETRIC_VERIFY"),
    ATAN: funBuilder("ATAN"),
    ATAN2: funBuilder("ATAN2"),
    AVG: funBuilder("AVG"),
    BENCHMARK: funBuilder("BENCHMARK"),
    BIN: funBuilder("BIN"),
    BINARY: funBuilder("BINARY"),
    BIT_AND: funBuilder("BIT_AND"),
    BIT_COUNT: funBuilder("BIT_COUNT"),
    BIT_LENGTH: funBuilder("BIT_LENGTH"),
    BIT_OR: funBuilder("BIT_OR"),
    BIT_XOR: funBuilder("BIT_XOR"),
    CAST: funBuilder("CAST"),
    CEIL: funBuilder("CEIL"),
    CEILING: funBuilder("CEILING"),
    CHAR: funBuilder("CHAR"),
    CHAR_LENGTH: funBuilder("CHAR_LENGTH"),
    CHARACTER_LENGTH: funBuilder("CHARACTER_LENGTH"),
    CHARSET: funBuilder("CHARSET"),
    COALESCE: funBuilder("COALESCE"),
    COERCIBILITY: funBuilder("COERCIBILITY"),
    COLLATION: funBuilder("COLLATION"),
    COMPRESS: funBuilder("COMPRESS"),
    CONCAT: funBuilder("CONCAT"),
    CONCAT_WS: funBuilder("CONCAT_WS"),
    CONNECTION_ID: funBuilder("CONNECTION_ID"),
    CONV: funBuilder("CONV"),
    CONVERT: funBuilder("CONVERT"),
    CONVERT_TZ: funBuilder("CONVERT_TZ"),
    COS: funBuilder("COS"),
    COT: funBuilder("COT"),
    COUNT: funBuilder("COUNT"),
    CRC32: funBuilder("CRC32"),
    CREATE_ASYMMETRIC_PRIV_KEY: funBuilder("CREATE_ASYMMETRIC_PRIV_KEY"),
    CREATE_ASYMMETRIC_PUB_KEY: funBuilder("CREATE_ASYMMETRIC_PUB_KEY"),
    CREATE_DH_PARAMETERS: funBuilder("CREATE_DH_PARAMETERS"),
    CREATE_DIGEST: funBuilder("CREATE_DIGEST"),
    CURRENT_DATE: funBuilder("CURRENT_DATE"),
    CURRENT_TIME: funBuilder("CURRENT_TIME"),
    CURRENT_TIMESTAMP: funBuilder("CURRENT_TIMESTAMP"),
    CURRENT_USER: funBuilder("CURRENT_USER"),
    CURTIME: funBuilder("CURTIME"),
    DATABASE: funBuilder("DATABASE"),
    DATE: funBuilder("DATE"),
    DATE_ADD: funBuilder("DATE_ADD"),
    DATE_FORMAT: funBuilder("DATE_FORMAT"),
    DATE_SUB: funBuilder("DATE_SUB"),
    DATEDIFF: funBuilder("DATEDIFF"),
    DAY: funBuilder("DAY"),
    DAYNAME: funBuilder("DAYNAME"),
    DAYOFMONTH: funBuilder("DAYOFMONTH"),
    DAYOFWEEK: funBuilder("DAYOFWEEK"),
    DAYOFYEAR: funBuilder("DAYOFYEAR"),
    DECODE: funBuilder("DECODE"),
    DEFAULT: funBuilder("DEFAULT"),
    DEGREES: funBuilder("DEGREES"),
    ELT: funBuilder("ELT"),
    ENCODE: funBuilder("ENCODE"),
    EXP: funBuilder("EXP"),
    EXPORT_SET: funBuilder("EXPORT_SET"),
    EXTRACT: funBuilder("EXTRACT"),
    ExtractValue: funBuilder("ExtractValue"),
    FIELD: funBuilder("FIELD"),
    FIND_IN_SET: funBuilder("FIND_IN_SET"),
    FLOOR: funBuilder("FLOOR"),
    FORMAT: funBuilder("FORMAT"),
    FOUND_ROWS: funBuilder("FOUND_ROWS"),
    FROM_BASE64: funBuilder("FROM_BASE64"),
    FROM_DAYS: funBuilder("FROM_DAYS"),
    FROM_UNIXTIME: funBuilder("FROM_UNIXTIME"),
    GET_FORMAT: funBuilder("GET_FORMAT"),
    GET_LOCK: funBuilder("GET_LOCK"),
    GREATEST: funBuilder("GREATEST"),
    GROUP_CONCAT: funBuilder("GROUP_CONCAT"),
    GTID_SUBSET: funBuilder("GTID_SUBSET"),
    GTID_SUBTRACT: funBuilder("GTID_SUBTRACT"),
    HEX: funBuilder("HEX"),
    HOUR: funBuilder("HOUR"),
    IF: funBuilder("IF"),
    IFNULL: funBuilder("IFNULL"),
    IN: funBuilder("IN"),
    INET_ATON: funBuilder("INET_ATON"),
    INET_NTOA: funBuilder("INET_NTOA"),
    INET6_ATON: funBuilder("INET6_ATON"),
    INET6_NTOA: funBuilder("INET6_NTOA"),
    INSERT: funBuilder("INSERT"),
    INSTR: funBuilder("INSTR"),
    INTERVAL: funBuilder("INTERVAL"),
    IS_FREE_LOCK: funBuilder("IS_FREE_LOCK"),
    IS_IPV4: funBuilder("IS_IPV4"),
    IS_IPV4_COMPAT: funBuilder("IS_IPV4_COMPAT"),
    IS_IPV4_MAPPED: funBuilder("IS_IPV4_MAPPED"),
    IS_IPV6: funBuilder("IS_IPV6"),
    IS_USED_LOCK: funBuilder("IS_USED_LOCK"),
    ISNULL: funBuilder("ISNULL"),
    JSON_APPEND: funBuilder("JSON_APPEND"),
    JSON_ARRAY: funBuilder("JSON_ARRAY"),
    JSON_ARRAY_APPEND: funBuilder("JSON_ARRAY_APPEND"),
    JSON_ARRAY_INSERT: funBuilder("JSON_ARRAY_INSERT"),
    JSON_CONTAINS: funBuilder("JSON_CONTAINS"),
    JSON_CONTAINS_PATH: funBuilder("JSON_CONTAINS_PATH"),
    JSON_DEPTH: funBuilder("JSON_DEPTH"),
    JSON_EXTRACT: funBuilder("JSON_EXTRACT"),
    JSON_INSERT: funBuilder("JSON_INSERT"),
    JSON_KEYS: funBuilder("JSON_KEYS"),
    JSON_LENGTH: funBuilder("JSON_LENGTH"),
    JSON_MERGE: funBuilder("JSON_MERGE"),
    JSON_OBJECT: funBuilder("JSON_OBJECT"),
    JSON_QUOTE: funBuilder("JSON_QUOTE"),
    JSON_REMOVE: funBuilder("JSON_REMOVE"),
    JSON_REPLACE: funBuilder("JSON_REPLACE"),
    JSON_SEARCH: funBuilder("JSON_SEARCH"),
    JSON_SET: funBuilder("JSON_SET"),
    JSON_TYPE: funBuilder("JSON_TYPE"),
    JSON_UNQUOTE: funBuilder("JSON_UNQUOTE"),
    JSON_VALID: funBuilder("JSON_VALID"),
    LAST_DAY: funBuilder("LAST_DAY"),
    LAST_INSERT_ID: funBuilder("LAST_INSERT_ID"),
    LCASE: funBuilder("LCASE"),
    LEAST: funBuilder("LEAST"),
    LEFT: funBuilder("LEFT"),
    LENGTH: funBuilder("LENGTH"),
    LN: funBuilder("LN"),
    LOAD_FILE: funBuilder("LOAD_FILE"),
    LOCALTIME: funBuilder("LOCALTIME"),
    LOCALTIMESTAMP: funBuilder("LOCALTIMESTAMP"),
    LOCATE: funBuilder("LOCATE"),
    LOG: funBuilder("LOG"),
    LOG10: funBuilder("LOG10"),
    LOG2: funBuilder("LOG2"),
    LOWER: funBuilder("LOWER"),
    LPAD: funBuilder("LPAD"),
    LTRIM: funBuilder("LTRIM"),
    MAKE_SET: funBuilder("MAKE_SET"),
    MAKEDATE: funBuilder("MAKEDATE"),
    MAKETIME: funBuilder("MAKETIME"),
    MASTER_POS_WAIT: funBuilder("MASTER_POS_WAIT"),
    MAX: funBuilder("MAX"),
    MBRContains: funBuilder("MBRContains"),
    MBRCoveredBy: funBuilder("MBRCoveredBy"),
    MBRCovers: funBuilder("MBRCovers"),
    MBRDisjoint: funBuilder("MBRDisjoint"),
    MBREquals: funBuilder("MBREquals"),
    MBRIntersects: funBuilder("MBRIntersects"),
    MBROverlaps: funBuilder("MBROverlaps"),
    MBRTouches: funBuilder("MBRTouches"),
    MBRWithin: funBuilder("MBRWithin"),
    MD5: funBuilder("MD5"),
    MICROSECOND: funBuilder("MICROSECOND"),
    MID: funBuilder("MID"),
    MIN: funBuilder("MIN"),
    MINUTE: funBuilder("MINUTE"),
    MONTH: funBuilder("MONTH"),
    MONTHNAME: funBuilder("MONTHNAME"),
    NAME_CONST: funBuilder("NAME_CONST"),
    NOW: funBuilder("NOW"),
    NULLIF: funBuilder("NULLIF"),
    OCT: funBuilder("OCT"),
    OCTET_LENGTH: funBuilder("OCTET_LENGTH"),
    OLD_PASSWORD: funBuilder("OLD_PASSWORD"),
    ORD: funBuilder("ORD"),
    PERIOD_ADD: funBuilder("PERIOD_ADD"),
    PERIOD_DIFF: funBuilder("PERIOD_DIFF"),
    PI: funBuilder("PI"),
    POSITION: funBuilder("POSITION"),
    POW: funBuilder("POW"),
    POWER: funBuilder("POWER"),
    QUARTER: funBuilder("QUARTER"),
    QUOTE: funBuilder("QUOTE"),
    RADIANS: funBuilder("RADIANS"),
    RAND: funBuilder("RAND"),
    RANDOM_BYTES: funBuilder("RANDOM_BYTES"),
    RELEASE_ALL_LOCKS: funBuilder("RELEASE_ALL_LOCKS"),
    RELEASE_LOCK: funBuilder("RELEASE_LOCK"),
    REPEAT: funBuilder("REPEAT"),
    REPLACE: funBuilder("REPLACE"),
    REVERSE: funBuilder("REVERSE"),
    RIGHT: funBuilder("RIGHT"),
    ROUND: funBuilder("ROUND"),
    ROW_COUNT: funBuilder("ROW_COUNT"),
    RPAD: funBuilder("RPAD"),
    RTRIM: funBuilder("RTRIM"),
    SCHEMA: funBuilder("SCHEMA"),
    SEC_TO_TIME: funBuilder("SEC_TO_TIME"),
    SECOND: funBuilder("SECOND"),
    SESSION_USER: funBuilder("SESSION_USER"),
    SHA1: funBuilder("SHA1"),
    SHA2: funBuilder("SHA2"),
    SIGN: funBuilder("SIGN"),
    SIN: funBuilder("SIN"),
    SLEEP: funBuilder("SLEEP"),
    SOUNDEX: funBuilder("SOUNDEX"),
    SPACE: funBuilder("SPACE"),
    SQRT: funBuilder("SQRT"),
    STD: funBuilder("STD"),
    STDDEV: funBuilder("STDDEV"),
    STDDEV_POP: funBuilder("STDDEV_POP"),
    STDDEV_SAMP: funBuilder("STDDEV_SAMP"),
    STR_TO_DATE: funBuilder("STR_TO_DATE"),
    STRCMP: funBuilder("STRCMP"),
    SUBDATE: funBuilder("SUBDATE"),
    SUBSTR: funBuilder("SUBSTR"),
    SUBSTRING: funBuilder("SUBSTRING"),
    SUBSTRING_INDEX: funBuilder("SUBSTRING_INDEX"),
    SUBTIME: funBuilder("SUBTIME"),
    SUM: funBuilder("SUM"),
    SYSDATE: funBuilder("SYSDATE"),
    SYSTEM_USER: funBuilder("SYSTEM_USER"),
    TAN: funBuilder("TAN"),
    TIME: funBuilder("TIME"),
    TIME_FORMAT: funBuilder("TIME_FORMAT"),
    TIME_TO_SEC: funBuilder("TIME_TO_SEC"),
    TIMEDIFF: funBuilder("TIMEDIFF"),
    TIMESTAMP: funBuilder("TIMESTAMP"),
    TIMESTAMPADD: funBuilder("TIMESTAMPADD"),
    TIMESTAMPDIFF: funBuilder("TIMESTAMPDIFF"),
    TO_BASE64: funBuilder("TO_BASE64"),
    TO_DAYS: funBuilder("TO_DAYS"),
    TO_SECONDS: funBuilder("TO_SECONDS"),
    TRIM: funBuilder("TRIM"),
    TRUNCATE: funBuilder("TRUNCATE"),
    UCASE: funBuilder("UCASE"),
    UNCOMPRESS: funBuilder("UNCOMPRESS"),
    UNCOMPRESSED_LENGTH: funBuilder("UNCOMPRESSED_LENGTH"),
    UNHEX: funBuilder("UNHEX"),
    UNIX_TIMESTAMP: funBuilder("UNIX_TIMESTAMP"),
    UpdateXML: funBuilder("UpdateXML"),
    UPPER: funBuilder("UPPER"),
    USER: funBuilder("USER"),
    UTC_DATE: funBuilder("UTC_DATE"),
    UTC_TIME: funBuilder("UTC_TIME"),
    UTC_TIMESTAMP: funBuilder("UTC_TIMESTAMP"),
    UUID: funBuilder("UUID"),
    UUID_SHORT: funBuilder("UUID_SHORT"),
    VALIDATE_PASSWORD_STRENGTH: funBuilder("VALIDATE_PASSWORD_STRENGTH"),
    VALUES: funBuilder("VALUES"),
    VAR_POP: funBuilder("VAR_POP"),
    VAR_SAMP: funBuilder("VAR_SAMP"),
    VARIANCE: funBuilder("VARIANCE"),
    VERSION: funBuilder("VERSION"),
    WAIT_FOR_EXECUTED_GTID_SET: funBuilder("WAIT_FOR_EXECUTED_GTID_SET"),
    WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS: funBuilder("WAIT_UNTIL_SQL_THREAD_AFTER_GTIDS"),
    WEEK: funBuilder("WEEK"),
    WEEKDAY: funBuilder("WEEKDAY"),
    WEEKOFYEAR: funBuilder("WEEKOFYEAR"),
    WEIGHT_STRING: funBuilder("WEIGHT_STRING"),
    YEAR: funBuilder("YEAR"),
    YEARWEEK: funBuilder("YEARWEEK"),
}
